# Прогрев аккаунтов через instagrapi

...

## Массовый запуск (50+ новых аккаунтов)

Если в задаче выбрано, например, 50 новых аккаунтов (только что привязанные прокси и пустые устройства):

- Конкурентность: в задаче укажите `concurrency` от 3 до 4. Внутри воркер использует пул `ThreadPoolExecutor(max_workers=min(concurrency, 4))`, то есть одновременно обрабатываются не более 4 аккаунтов. Остальные 46+ ждут очереди. Это снижает риски бана и сетевых лимитов.
- Порядок и задержки между аккаунтами: перед стартом каждого аккаунта ставится пауза `random.uniform(delay_min_sec, delay_max_sec)` (значения задаются в форме). При 50 аккаунтах и, например, 15–45 сек задержки суммарное время будет распределено естественно.
- Первичная фиксация устройства/сессии: для аккаунтов без записей в `InstagramDevice` модуль после первого успешного логина сохранит `device_settings` (включая `uuids`) и `user_agent`, а также `session_settings`. Все последующие операции пойдут строго «с одного устройства» и «с одного IP» (привязанный прокси).
- IP/прокси: для каждого аккаунта берётся `WarmupTaskAccount.proxy` → или `InstagramAccount.current_proxy` → или `InstagramAccount.proxy`. Важно заранее привязать к каждому аккаунту свой прокси, чтобы избежать пересечений IP.
- Человечность: instagrapi `cl.delay_range = [1, 3]` и дополнительные `sleep` внутри действий (скролл, лайк, сторис, follow). Это снижает плотность запросов.
- Ретраи/челенджи: `IGAuthService.ensure_logged_in()` обрабатывает 2FA/Challenge. Если для новых аккаунтов ожидается частый challenge — заранее подключите провайдер кода (email/TOTP) в `code_providers`.

### Рекомендованный сценарий для новых аккаунтов
1. День 1: задать мягкие параметры — только лента (1–2 скролла), 0–1 лайк, 0–1 сторис, 0 follow; конкуренция 3–4.
2. День 2–3: постепенно добавить лайки 1–3, сторис 1–3, follow 0–1 из выбранной категории.
3. После стабилизации (валидные сессии): увеличить количество скроллов/сторис, оставаясь в безопасных пределах.

### Оценка времени задачи
- При 50 аккаунтах и `concurrency=4` одновременно идут 4, остальные в очереди.
- Считайте: время на один аккаунт (действия) + средняя межаккаунтная пауза. Например, если на аккаунт в среднем уходит ~30–60 сек, а между стартами 15–45 сек, суммарная длительность будет в пределах нескольких часов — зависит от выбранных диапазонов.

### Ротация/паузы между батчами
- Для очень больших списков имеет смысл запускать несколько задач по 30–50 аккаунтов с перерывом в 30–60 минут между задачами.

### Минимальные требования к данным
- У каждого аккаунта должен быть привязанный прокси.
- Рекомендуется заранее добавить `InstagramDevice` (не обязательно — сервис создаст запись при первом запуске), чтобы сразу задать `user_agent`/локаль/страну.

...